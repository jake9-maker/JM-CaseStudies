---
phase: 01-foundation-site-structure
plan: 03
type: execute
---

<objective>
Configure GitHub Actions workflow for automated Astro deployment to GitHub Pages.

Purpose: Establish CI/CD pipeline so site automatically builds and deploys to GitHub Pages on every push to main branch, eliminating manual deployment steps and ensuring build always succeeds before publishing.

Output: GitHub Actions workflow (.github/workflows/deploy.yml), deployment verified, and site live on GitHub Pages.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-site-structure/01-RESEARCH.md
@.planning/phases/01-foundation-site-structure/01-01-SUMMARY.md
@.planning/phases/01-foundation-site-structure/01-02-SUMMARY.md

**Key findings from research:**
- GitHub Actions is native to GitHub, no external CI/CD service needed
- Astro has official GitHub Pages deployment documentation
- Workflow must: checkout code, setup Node, install dependencies, build Astro, deploy to gh-pages
- GitHub Pages is configured to use GitHub Actions as build source (for public repos)
- Permissions: pages: write, id-token: write required
- No secrets needed for public GitHub Pages

**From prior plans:**
- Astro configured with site, base, output: 'static'
- Project builds successfully with `npm run build` (creates dist/)
- Content collection structure established
- All pages and components ready

**Deployment flow:**
- Repository must be public for GitHub Pages
- GitHub Pages configured to use GitHub Actions as build source
- Branch: main â†’ trigger build, deploy to gh-pages branch
- GitHub automatically serves from gh-pages
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GitHub Actions workflow for Astro deployment</name>
  <files>.github/workflows/deploy.yml</files>
  <action>
    1. Create .github/workflows/ directory if it doesn't exist
    2. Create deploy.yml workflow file with:
       - name: Deploy Astro to GitHub Pages
       - trigger: on push to main branch (and manual workflow dispatch)
       - permissions: pages: write, id-token: write (required for GitHub Pages)
       - checkout@v4 to get code
       - setup-node@v4 with node-version: '18' or '20' (Node 18+ required for Astro)
       - run `npm ci` to install dependencies
       - run `npm run build` to build Astro project (creates dist/)
       - upload-pages-artifact@v2 to prepare dist/ for deployment
       - deploy-pages@v2 to deploy to GitHub Pages
    3. Include helpful comments explaining each step
    4. Ensure workflow uses standard permissions (no extra secrets needed)
    Rationale: GitHub Actions native and free. Official Astro workflow pattern. Modern deployment method.
    Avoid: Don't use legacy GitHub Pages methods. Don't add unnecessary minification steps (Phase 4 can optimize).
  </action>
  <verify>
    - .github/workflows/deploy.yml exists and is valid YAML
    - `cat .github/workflows/deploy.yml` shows correct permissions and steps
    - Workflow includes checkout, setup-node, npm ci, build, upload artifact, and deploy steps
  </verify>
  <done>GitHub Actions workflow created and ready to test</done>
</task>

<task type="auto">
  <name>Task 2: Commit workflow and prepare for deployment</name>
  <files>.github/workflows/deploy.yml</files>
  <action>
    1. Commit the workflow file to git: `git add .github/workflows/deploy.yml && git commit -m "..."`
    2. Verify git status shows clean working tree
    3. Ensure repository is public (GitHub Pages requirement for free tier)
    4. Check GitHub repository Settings â†’ Pages:
       - Verify "Build and deployment" section exists
       - Set source to "GitHub Actions" (not "Deploy from a branch")
    Rationale: Workflow must be committed for GitHub to recognize it. Public repo required for free GitHub Pages. Correct source setting enables automatic builds.
    Avoid: Don't leave workflow uncommitted. Don't try to deploy from gh-pages branch manually.
  </action>
  <verify>
    - Workflow file committed to git
    - `git log -1 --oneline` shows workflow commit
    - Repository is public (Settings â†’ General shows "Public" label)
  </verify>
  <done>Workflow committed, repository configured for GitHub Actions</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>GitHub Actions workflow configured for automated Astro deployment</what-built>
  <how-to-verify>
    1. Push your code to GitHub: `git push origin main`
    2. Visit your repository on GitHub.com (https://github.com/jmaisel/JM-CaseStudies)
    3. Go to Actions tab (top navigation menu)
    4. Confirm:
       - You see a workflow run for your commit
       - Status shows green checkmark (PASSED) or yellow hourglass (IN PROGRESS)
       - Wait 1-2 minutes if in progress
    5. Once workflow succeeds, visit Settings â†’ Pages
    6. Confirm GitHub Pages URL is displayed (should be https://jmaisel.github.io/JM-CaseStudies/)
    7. Visit your live site:
       - Open https://jmaisel.github.io/JM-CaseStudies/
       - Page should load (may take 30-60 seconds after first deploy)
       - Verify you see homepage content
       - Click "Projects" link - should show projects listing
       - Click project title - should show individual project page
       - No 404 errors in browser console
  </how-to-verify>
  <resume-signal>Type "approved" if deployment works, or describe any issues to fix</resume-signal>
</task>

<task type="auto">
  <name>Task 4: Document deployment process and enable automatic future deployments</name>
  <files>.github/workflows/deploy.yml, README.md (optional)</files>
  <action>
    1. Verify workflow is set to trigger on push to main branch
    2. Workflow can also be manually triggered via Actions tab if needed (via workflow_dispatch)
    3. Future pushes to main will automatically trigger deployment
    4. Optional: Create brief deployment docs (can add to README.md later):
       - Explain that site auto-deploys on push to main
       - Explain GitHub Pages URL
       - Note that builds take 1-2 minutes
    5. Verify dist/ is in .gitignore (build output should not be committed)
    Rationale: Auto-deployment on push ensures main branch is always live. Workflow is now hands-off - just push and site updates.
    Avoid: Don't commit dist/ directory - GitHub Actions builds it fresh each time.
  </action>
  <verify>
    - Workflow trigger set to push to main branch
    - dist/ is in .gitignore
    - No build artifacts in committed code
    - Site is live and accessible at GitHub Pages URL
  </verify>
  <done>Deployment automated and verified, site live on GitHub Pages</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] .github/workflows/deploy.yml exists with correct structure
- [ ] Workflow committed to git
- [ ] Repository is public
- [ ] GitHub Pages source set to "GitHub Actions"
- [ ] Workflow runs successfully (green checkmark in Actions tab)
- [ ] Site is live at GitHub Pages URL
- [ ] Homepage loads without errors
- [ ] Projects page and individual project pages accessible
- [ ] No build artifacts committed to git
</verification>

<success_criteria>

- GitHub Actions workflow created and committed
- Deployment pipeline verified end-to-end
- Site live on GitHub Pages (https://jmaisel.github.io/JM-CaseStudies/)
- Automatic deployment on push to main enabled
- Manual workflow trigger available if needed
- No build errors or warnings in workflow logs
- Future deployments will happen automatically
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-site-structure/01-03-SUMMARY.md`:

# Phase 1 Plan 3: Astro Deployment Pipeline Summary

**GitHub Actions workflow configured, Astro site deployed live to GitHub Pages**

## Accomplishments

- GitHub Actions workflow created (.github/workflows/deploy.yml)
- Workflow configured to trigger on push to main branch
- Workflow builds Astro project and deploys to GitHub Pages
- End-to-end deployment verified
- Site live and accessible at GitHub Pages URL
- Automatic deployment on future pushes enabled
- Manual workflow trigger available via Actions tab

## Files Created/Modified

- `.github/workflows/deploy.yml` - GitHub Actions deployment workflow

## Decisions Made

- **CI/CD platform:** GitHub Actions selected (native, free, no external service)
- **Build trigger:** Automatic on push to main branch
- **Deployment method:** GitHub Actions â†’ dist/ â†’ GitHub Pages
- **Build tool:** Astro with npm (standard Node.js approach)

## Issues Encountered

None

## Next Phase Readiness

âœ… **Phase 1 Complete!** Foundation established:
- Astro project initialized and configured
- Component structure and layouts ready
- Markdown content collection configured
- GitHub Actions deployment pipeline live
- Placeholder projects ready for Phase 2 design work
- Automatic deployment on git push enabled

ðŸš€ **Ready for Phase 2:** Homepage Design & Implementation can now proceed with knowledge that:
- Site auto-deploys on every push
- Content structure is stable and type-safe
- Components ready for styling and layout work
- Three placeholder projects will automatically publish as content is added

Key advantage: Astro's component-based approach aligns with coworker's knowledge, enabling knowledge sharing and pattern reuse.
</output>
